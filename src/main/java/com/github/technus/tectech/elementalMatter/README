TO CHANGE DEFINITION YOU MUST INSTANTIATE IT ONCE MORE (from scratch, failing to do that will end up in the heavy bugs)!

 Example complex definition:

 Bottom

 PrimitiveDef
 |
 DefStack
 |||||
 DefStackTree
 |
 ..... ETC up to the point when you can no longer make NBT to save it (128 levels - already used ones)
 Def - definition of the parent stack
 |
 DefStack - stacks that build the parent definition
 |||||multiple to 1
 DefStackTree - internal storage for components of parent def
 |
 Def - definition of the parent stack
 |
 DefStack - stacks that build the parent definition
 |||||multiple to 1
 DefStackTree - internal storage for components of parent def
 |
 Definition - top hierarchy definition
 | 1 to 1
 DefinitionStack - for recipe comparisons
 OR
 InstanceStack - real things

 TOP

Trees:

 DefinitionStack - def stack
 |||||multiple to 1
 DefinitionStackTree - def container - for recipe comparisons


 InstanceStack - inst stack
 |||||multiple to 1
 InstanceStackTree - inst container - real things go here